// Generated by CoffeeScript 1.3.3
(function() {

  app.implement(function(trigger, target, classNames) {
    var bindBodyClick, bindModalOpen, close, init, onBodyClick, self, setup, toggle;
    self = {};
    toggle = null;
    close = function() {
      if (toggle.isOn()) {
        return toggle.toggle();
      }
    };
    onBodyClick = function(e) {
      var realTarget;
      realTarget = e.toElement != null ? $(e.toElement) : $(e.target);
      if (realTarget.closest(trigger.add(target)).length === 0) {
        return close();
      }
    };
    bindBodyClick = function() {
      return app.event.bind('click', null, onBodyClick);
    };
    bindModalOpen = function() {
      return app.event.on('modal.open', function() {
        return close();
      });
    };
    init = function() {
      setup();
      bindBodyClick();
      return bindModalOpen();
    };
    setup = function() {
      return toggle = app.ui.classToggle.create(trigger, target, {
        trigger: classNames.trigger,
        target: classNames.target
      });
    };
    init();
    return self;
  }, ['ui', 'dropdown', 'create'], false);

}).call(this);
